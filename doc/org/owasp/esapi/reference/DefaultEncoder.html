<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.4.2_18) on Mon Nov 03 11:34:22 EST 2008 -->
<TITLE>
DefaultEncoder
</TITLE>

<META NAME="keywords" CONTENT="org.owasp.esapi.reference.DefaultEncoder class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="DefaultEncoder";
}
</SCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/DefaultEncoder.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../../../../org/owasp/esapi/reference/DefaultEncryptedProperties.html" title="class in org.owasp.esapi.reference"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="DefaultEncoder.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>

</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.owasp.esapi.reference</FONT>
<BR>
Class DefaultEncoder</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by"><B>org.owasp.esapi.reference.DefaultEncoder</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></DD>
</DL>
<HR>
<DL>
<DT>public class <B>DefaultEncoder</B><DT>extends java.lang.Object<DT>implements <A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></DL>

<P>
Reference implementation of the Encoder interface. This implementation takes
 a whitelist approach to encoding, meaning that everything not specifically identified in a
 list of "immune" characters is encoded. Several methods follow the approach in the <a
 href="http://www.microsoft.com/downloads/details.aspx?familyid=efb9c819-53ff-4f82-bfaf-e11625130c25&displaylang=en">Microsoft
 AntiXSS Library</a>.
 <p>
 The Encoder performs two key functions
 The canonicalization algorithm is complex, as it has to be able to recognize
 encoded characters that might affect downstream interpreters without being
 told what encodings are possible. The stream is read one character at a time.
 If an encoded character is encountered, it is canonicalized and pushed back
 onto the stream. If the next character is encoded, then a intrusion exception
 is thrown for the double-encoding which is assumed to be an attack.
 <p>
 The encoding methods also attempt to prevent double encoding, by canonicalizing strings
 that are passed to them for encoding.
 <p>
 Currently the implementation supports:
 <ul>
 <li>HTML Entity Encoding (including non-terminated)</li>
 <li>Percent Encoding</li>
 <li>Backslash Encoding</li>
 </ul>
<P>

<P>
<DL>
<DT><B>Since:</B></DT>
  <DD>June 1, 2007</DD>
<DT><B>Author:</B></DT>
  <DD>Jeff Williams (jeff.williams .at. aspectsecurity.com) <a
         href="http://www.aspectsecurity.com">Aspect Security</a></DD>
<DT><B>See Also:</B><DD><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi"><CODE>Encoder</CODE></A></DL>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->


<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Field Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;java.util.List</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#codecs">codecs</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_org.owasp.esapi.Encoder"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Fields inherited from interface org.owasp.esapi.<A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#CHAR_ALPHANUMERICS">CHAR_ALPHANUMERICS</A>, <A HREF="../../../../org/owasp/esapi/Encoder.html#CHAR_DIGITS">CHAR_DIGITS</A>, <A HREF="../../../../org/owasp/esapi/Encoder.html#CHAR_LETTERS">CHAR_LETTERS</A>, <A HREF="../../../../org/owasp/esapi/Encoder.html#CHAR_LOWERS">CHAR_LOWERS</A>, <A HREF="../../../../org/owasp/esapi/Encoder.html#CHAR_PASSWORD_DIGITS">CHAR_PASSWORD_DIGITS</A>, <A HREF="../../../../org/owasp/esapi/Encoder.html#CHAR_PASSWORD_LETTERS">CHAR_PASSWORD_LETTERS</A>, <A HREF="../../../../org/owasp/esapi/Encoder.html#CHAR_PASSWORD_LOWERS">CHAR_PASSWORD_LOWERS</A>, <A HREF="../../../../org/owasp/esapi/Encoder.html#CHAR_PASSWORD_SPECIALS">CHAR_PASSWORD_SPECIALS</A>, <A HREF="../../../../org/owasp/esapi/Encoder.html#CHAR_PASSWORD_UPPERS">CHAR_PASSWORD_UPPERS</A>, <A HREF="../../../../org/owasp/esapi/Encoder.html#CHAR_SPECIALS">CHAR_SPECIALS</A>, <A HREF="../../../../org/owasp/esapi/Encoder.html#CHAR_UPPERS">CHAR_UPPERS</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#DefaultEncoder()">DefaultEncoder</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Instantiates a new DefaultEncoder</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#DefaultEncoder(java.util.List)">DefaultEncoder</A></B>(java.util.List&nbsp;codecs)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Instantiates a new DefaultEncoder</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Method Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#canonicalize(java.lang.String)">canonicalize</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method performs canonicalization on data received to ensure that it
 has been reduced to its most basic form before validation. For example,
 URL-encoded data received from ordinary "application/x-www-url-encoded"
 forms so that it may be validated properly.
 <p>
 Canonicalization is simply the operation of reducing a possibly encoded
 string down to its simplest form. This is important, because attackers
 frequently use encoding to change their input in a way that will bypass
 validation filters, but still be interpreted properly by the target of
 the attack. Note that data encoded more than once is not something that a
 normal user would generate and should be regarded as an attack.
 <P>
 For input that comes from an HTTP servlet request, there are generally
 two types of encoding to be concerned with. The first is
 "applicaton/x-www-url-encoded" which is what is typically used in most
 forms and URI's where characters are encoded in a %xy format. The other
 type of common character encoding is HTML entity encoding, which uses
 several formats:
 <P>
 <PRE>&lt;</PRE>,
 <PRE>&#117;</PRE>, and
 <PRE>&#x3a;</PRE>.
 <P>
 Note that all of these formats may possibly render properly in a
 browser without the trailing semicolon.
 <P>
 Double-encoding is a particularly thorny problem, as applying ordinary decoders
 may introduce encoded characters, even characters encoded with a different
 encoding scheme. For example %26lt; is a < character which has been entity encoded
 and then the first character has been url-encoded. Implementations should
 throw an IntrusionException when double-encoded characters are detected.
 <P>
 Note that there is also "multipart/form" encoding, which allows files and
 other binary data to be transmitted. Each part of a multipart form can
 itself be encoded according to a "Content-Transfer-Encoding" header. See
 the HTTPUtilties.getSafeFileUploads() method.
 <P>
 For more information on form encoding, please refer to the <a
 href="http://www.w3.org/TR/html4/interact/forms.html#h-17.13.4">W3C
 specifications</a>.
 <p>
 This method is equivalent to calling <pre>Encoder.canonicalize(input, true);</pre></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#canonicalize(java.lang.String, boolean)">canonicalize</A></B>(java.lang.String&nbsp;input,
             boolean&nbsp;strict)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method performs canonicalization on data received to ensure that it
 has been reduced to its most basic form before validation. For example,
 URL-encoded data received from ordinary "application/x-www-url-encoded"
 forms so that it may be validated properly.
 <p>
 Canonicalization is simply the operation of reducing a possibly encoded
 string down to its simplest form. This is important, because attackers
 frequently use encoding to change their input in a way that will bypass
 validation filters, but still be interpreted properly by the target of
 the attack. Note that data encoded more than once is not something that a
 normal user would generate and should be regarded as an attack.
 <P>
 For input that comes from an HTTP servlet request, there are generally
 two types of encoding to be concerned with. The first is
 "applicaton/x-www-url-encoded" which is what is typically used in most
 forms and URI's where characters are encoded in a %xy format. The other
 type of common character encoding is HTML entity encoding, which uses
 several formats:
 <P>
 <PRE>&lt;</PRE>,
 <PRE>&#117;</PRE>, and
 <PRE>&#x3a;</PRE>.
 <P>
 Note that all of these formats may possibly render properly in a
 browser without the trailing semicolon.
 <P>
 Double-encoding is a particularly thorny problem, as applying ordinary decoders
 may introduce encoded characters, even characters encoded with a different
 encoding scheme. For example %26lt; is a < character which has been entity encoded
 and then the first character has been url-encoded. Implementations should
 throw an IntrusionException when double-encoded characters are detected.
 <P>
 Note that there is also "multipart/form" encoding, which allows files and
 other binary data to be transmitted. Each part of a multipart form can
 itself be encoded according to a "Content-Transfer-Encoding" header. See
 the HTTPUtilties.getSafeFileUploads() method.
 <P>
 For more information on form encoding, please refer to the 
 <a href="http://www.w3.org/TR/html4/interact/forms.html#h-17.13.4">W3C specifications</a>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#decodeFromBase64(java.lang.String)">decodeFromBase64</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decode data encoded with BASE-64 encoding.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#decodeFromURL(java.lang.String)">decodeFromURL</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decode from URL. Implementations should first canonicalize and
 detect any double-encoding. If this check passes, then the data is decoded using URL
 decoding.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#encodeForBase64(byte[], boolean)">encodeForBase64</A></B>(byte[]&nbsp;input,
                boolean&nbsp;wrap)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode for Base64.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#encodeForCSS(java.lang.String)">encodeForCSS</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode data for use in Cascading Style Sheets (CSS) content.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#encodeForDN(java.lang.String)">encodeForDN</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode data for use in an LDAP distinguished name.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#encodeForHTML(java.lang.String)">encodeForHTML</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode data for use in HTML using HTML entity encoding
 <p> 
 Note that the following characters:
 00–08, 0B–0C, 0E–1F, and 7F–9F 
 <p>cannot be used in HTML.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#encodeForHTMLAttribute(java.lang.String)">encodeForHTMLAttribute</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode data for use in HTML attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#encodeForJavaScript(java.lang.String)">encodeForJavaScript</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode data for insertion inside a data value in JavaScript. Putting user data directly
 inside a script is quite dangerous. Great care must be taken to prevent putting user data
 directly into script code itself, as no amount of encoding will prevent attacks there.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#encodeForLDAP(java.lang.String)">encodeForLDAP</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode data for use in LDAP queries.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#encodeForOS(org.owasp.esapi.codecs.Codec, java.lang.String)">encodeForOS</A></B>(<A HREF="../../../../org/owasp/esapi/codecs/Codec.html" title="interface in org.owasp.esapi.codecs">Codec</A>&nbsp;codec,
            java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode for an operating system command shell according to the selected codec (appropriate codecs include
 the WindowsCodec and UnixCodec).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#encodeForSQL(org.owasp.esapi.codecs.Codec, java.lang.String)">encodeForSQL</A></B>(<A HREF="../../../../org/owasp/esapi/codecs/Codec.html" title="interface in org.owasp.esapi.codecs">Codec</A>&nbsp;codec,
             java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode input for use in a SQL query, according to the selected codec 
 (appropriate codecs include the MySQLCodec and OracleCodec).
 
 This method is not recommended. The use of the PreparedStatement 
 interface is the preferred approach. However, if for some reason 
 this is impossible, then this method is provided as a weaker 
 alternative. 
 
 The best approach is to make sure any single-quotes are double-quoted.
 Another possible approach is to use the {escape} syntax described in the
 JDBC specification in section 1.5.6.
 
 However, this syntax does not work with all drivers, and requires
 modification of all queries.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#encodeForURL(java.lang.String)">encodeForURL</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode for use in a URL. This method performs <a
 href="http://en.wikipedia.org/wiki/Percent-encoding">URL encoding</a>
 on the entire string.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#encodeForVBScript(java.lang.String)">encodeForVBScript</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode data for insertion inside a data value in a Visual Basic script. Putting user data directly
 inside a script is quite dangerous. Great care must be taken to prevent putting user data
 directly into script code itself, as no amount of encoding will prevent attacks there.
 
 This method is not recommended as VBScript is only supported by Internet Explorer</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#encodeForXML(java.lang.String)">encodeForXML</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode data for use in an XML element. The implementation should follow the <a
 href="http://www.w3schools.com/xml/xml_encoding.asp">XML Encoding
 Standard</a> from the W3C.
 <p>
 The use of a real XML parser is strongly encouraged. However, in the
 hopefully rare case that you need to make sure that data is safe for
 inclusion in an XML document and cannot use a parse, this method provides
 a safe mechanism to do so.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#encodeForXMLAttribute(java.lang.String)">encodeForXMLAttribute</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode data for use in an XML attribute. The implementation should follow
 the <a href="http://www.w3schools.com/xml/xml_encoding.asp">XML Encoding
 Standard</a> from the W3C.
 <p>
 The use of a real XML parser is highly encouraged. However, in the
 hopefully rare case that you need to make sure that data is safe for
 inclusion in an XML document and cannot use a parse, this method provides
 a safe mechanism to do so.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#encodeForXPath(java.lang.String)">encodeForXPath</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode data for use in an XPath query.
 
 NB: The reference implementation encodes almost everything and may over-encode. 
 
 The difficulty with XPath encoding is that XPath has no built in mechanism for escaping
 characters. It is possible to use XQuery in a parameterized way to
 prevent injection. 
 
 For more information, refer to <a
 href="http://www.ibm.com/developerworks/xml/library/x-xpathinjection.html">this
 article</a> which specifies the following list of characters as the most
 dangerous: ^&"*';<>(). <a
 href="http://www.packetstormsecurity.org/papers/bypass/Blind_XPath_Injection_20040518.pdf">This
 paper</a> suggests disallowing ' and " in queries.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#isContained(char[], char)">isContained</A></B>(char[]&nbsp;haystack,
            char&nbsp;c)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isContained is a helper method which determines if c is 
 contained in the character array haystack.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/DefaultEncoder.html#normalize(java.lang.String)">normalize</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduce all non-ascii characters to their ASCII form so that simpler
 validation rules can be applied. For example, an accented-e character
 will be changed into a regular ASCII e character.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Methods inherited from class java.lang.Object</B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Field Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="codecs"><!-- --></A><H3>
codecs</H3>
<PRE>
java.util.List <B>codecs</B></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="DefaultEncoder()"><!-- --></A><H3>
DefaultEncoder</H3>
<PRE>
public <B>DefaultEncoder</B>()</PRE>
<DL>
<DD>Instantiates a new DefaultEncoder
<P>
</DL>
<HR>

<A NAME="DefaultEncoder(java.util.List)"><!-- --></A><H3>
DefaultEncoder</H3>
<PRE>
public <B>DefaultEncoder</B>(java.util.List&nbsp;codecs)</PRE>
<DL>
<DD>Instantiates a new DefaultEncoder
<P>
<DT><B>Parameters:</B><DD><CODE>codecs</CODE> - A list of codecs to use by the Encoder class
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - If the encoder is not an instance of the Codec interface</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Method Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="canonicalize(java.lang.String)"><!-- --></A><H3>
canonicalize</H3>
<PRE>
public java.lang.String <B>canonicalize</B>(java.lang.String&nbsp;input)</PRE>
<DL>
<DD>This method performs canonicalization on data received to ensure that it
 has been reduced to its most basic form before validation. For example,
 URL-encoded data received from ordinary "application/x-www-url-encoded"
 forms so that it may be validated properly.
 <p>
 Canonicalization is simply the operation of reducing a possibly encoded
 string down to its simplest form. This is important, because attackers
 frequently use encoding to change their input in a way that will bypass
 validation filters, but still be interpreted properly by the target of
 the attack. Note that data encoded more than once is not something that a
 normal user would generate and should be regarded as an attack.
 <P>
 For input that comes from an HTTP servlet request, there are generally
 two types of encoding to be concerned with. The first is
 "applicaton/x-www-url-encoded" which is what is typically used in most
 forms and URI's where characters are encoded in a %xy format. The other
 type of common character encoding is HTML entity encoding, which uses
 several formats:
 <P>
 <PRE>&lt;</PRE>,
 <PRE>&#117;</PRE>, and
 <PRE>&#x3a;</PRE>.
 <P>
 Note that all of these formats may possibly render properly in a
 browser without the trailing semicolon.
 <P>
 Double-encoding is a particularly thorny problem, as applying ordinary decoders
 may introduce encoded characters, even characters encoded with a different
 encoding scheme. For example %26lt; is a < character which has been entity encoded
 and then the first character has been url-encoded. Implementations should
 throw an IntrusionException when double-encoded characters are detected.
 <P>
 Note that there is also "multipart/form" encoding, which allows files and
 other binary data to be transmitted. Each part of a multipart form can
 itself be encoded according to a "Content-Transfer-Encoding" header. See
 the HTTPUtilties.getSafeFileUploads() method.
 <P>
 For more information on form encoding, please refer to the <a
 href="http://www.w3.org/TR/html4/interact/forms.html#h-17.13.4">W3C
 specifications</a>.
 <p>
 This method is equivalent to calling <pre>Encoder.canonicalize(input, true);</pre>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#canonicalize(java.lang.String)">canonicalize</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to canonicalize
<DT><B>Returns:</B><DD>a String containing the canonicalized text<DT><B>See Also:</B><DD><a href="http://www.w3.org/TR/html4/interact/forms.html#h-17.13.4">W3C specifications</a></DL>
</DD>
</DL>
<HR>

<A NAME="canonicalize(java.lang.String, boolean)"><!-- --></A><H3>
canonicalize</H3>
<PRE>
public java.lang.String <B>canonicalize</B>(java.lang.String&nbsp;input,
                                     boolean&nbsp;strict)</PRE>
<DL>
<DD>This method performs canonicalization on data received to ensure that it
 has been reduced to its most basic form before validation. For example,
 URL-encoded data received from ordinary "application/x-www-url-encoded"
 forms so that it may be validated properly.
 <p>
 Canonicalization is simply the operation of reducing a possibly encoded
 string down to its simplest form. This is important, because attackers
 frequently use encoding to change their input in a way that will bypass
 validation filters, but still be interpreted properly by the target of
 the attack. Note that data encoded more than once is not something that a
 normal user would generate and should be regarded as an attack.
 <P>
 For input that comes from an HTTP servlet request, there are generally
 two types of encoding to be concerned with. The first is
 "applicaton/x-www-url-encoded" which is what is typically used in most
 forms and URI's where characters are encoded in a %xy format. The other
 type of common character encoding is HTML entity encoding, which uses
 several formats:
 <P>
 <PRE>&lt;</PRE>,
 <PRE>&#117;</PRE>, and
 <PRE>&#x3a;</PRE>.
 <P>
 Note that all of these formats may possibly render properly in a
 browser without the trailing semicolon.
 <P>
 Double-encoding is a particularly thorny problem, as applying ordinary decoders
 may introduce encoded characters, even characters encoded with a different
 encoding scheme. For example %26lt; is a < character which has been entity encoded
 and then the first character has been url-encoded. Implementations should
 throw an IntrusionException when double-encoded characters are detected.
 <P>
 Note that there is also "multipart/form" encoding, which allows files and
 other binary data to be transmitted. Each part of a multipart form can
 itself be encoded according to a "Content-Transfer-Encoding" header. See
 the HTTPUtilties.getSafeFileUploads() method.
 <P>
 For more information on form encoding, please refer to the 
 <a href="http://www.w3.org/TR/html4/interact/forms.html#h-17.13.4">W3C specifications</a>.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#canonicalize(java.lang.String, boolean)">canonicalize</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to canonicalize<DD><CODE>strict</CODE> - true if checking for double encoding is desired, false otherwise
<DT><B>Returns:</B><DD>a String containing the canonicalized text<DT><B>See Also:</B><DD><a href="http://www.w3.org/TR/html4/interact/forms.html#h-17.13.4">W3C specifications</a></DL>
</DD>
</DL>
<HR>

<A NAME="normalize(java.lang.String)"><!-- --></A><H3>
normalize</H3>
<PRE>
public java.lang.String <B>normalize</B>(java.lang.String&nbsp;input)</PRE>
<DL>
<DD>Reduce all non-ascii characters to their ASCII form so that simpler
 validation rules can be applied. For example, an accented-e character
 will be changed into a regular ASCII e character.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#normalize(java.lang.String)">normalize</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to normalize
<DT><B>Returns:</B><DD>a normalized String</DL>
</DD>
</DL>
<HR>

<A NAME="encodeForHTML(java.lang.String)"><!-- --></A><H3>
encodeForHTML</H3>
<PRE>
public java.lang.String <B>encodeForHTML</B>(java.lang.String&nbsp;input)</PRE>
<DL>
<DD>Encode data for use in HTML using HTML entity encoding
 <p> 
 Note that the following characters:
 00–08, 0B–0C, 0E–1F, and 7F–9F 
 <p>cannot be used in HTML.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#encodeForHTML(java.lang.String)">encodeForHTML</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to encode for HTML
<DT><B>Returns:</B><DD>input encoded for HTML<DT><B>See Also:</B><DD><a href="http://en.wikipedia.org/wiki/Character_encodings_in_HTML">HTML Encodings [wikipedia.org]</a>, 
<a href="http://www.w3.org/TR/html4/sgml/sgmldecl.html">SGML Specification [w3.org]</a>, 
<a href="http://www.w3.org/TR/REC-xml/#charsets">XML Specification [w3.org]</a></DL>
</DD>
</DL>
<HR>

<A NAME="encodeForHTMLAttribute(java.lang.String)"><!-- --></A><H3>
encodeForHTMLAttribute</H3>
<PRE>
public java.lang.String <B>encodeForHTMLAttribute</B>(java.lang.String&nbsp;input)</PRE>
<DL>
<DD>Encode data for use in HTML attributes.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#encodeForHTMLAttribute(java.lang.String)">encodeForHTMLAttribute</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to encode for an HTML attribute
<DT><B>Returns:</B><DD>input encoded for use as an HTML attribute</DL>
</DD>
</DL>
<HR>

<A NAME="encodeForCSS(java.lang.String)"><!-- --></A><H3>
encodeForCSS</H3>
<PRE>
public java.lang.String <B>encodeForCSS</B>(java.lang.String&nbsp;input)</PRE>
<DL>
<DD>Encode data for use in Cascading Style Sheets (CSS) content.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#encodeForCSS(java.lang.String)">encodeForCSS</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to encode for CSS
<DT><B>Returns:</B><DD>input encoded for CSS<DT><B>See Also:</B><DD><a href="http://www.w3.org/TR/CSS21/syndata.html#escaped-characters">CSS Syntax [w3.org]</a></DL>
</DD>
</DL>
<HR>

<A NAME="encodeForJavaScript(java.lang.String)"><!-- --></A><H3>
encodeForJavaScript</H3>
<PRE>
public java.lang.String <B>encodeForJavaScript</B>(java.lang.String&nbsp;input)</PRE>
<DL>
<DD>Encode data for insertion inside a data value in JavaScript. Putting user data directly
 inside a script is quite dangerous. Great care must be taken to prevent putting user data
 directly into script code itself, as no amount of encoding will prevent attacks there.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#encodeForJavaScript(java.lang.String)">encodeForJavaScript</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to encode for JavaScript
<DT><B>Returns:</B><DD>input encoded for use in JavaScript</DL>
</DD>
</DL>
<HR>

<A NAME="encodeForVBScript(java.lang.String)"><!-- --></A><H3>
encodeForVBScript</H3>
<PRE>
public java.lang.String <B>encodeForVBScript</B>(java.lang.String&nbsp;input)</PRE>
<DL>
<DD>Encode data for insertion inside a data value in a Visual Basic script. Putting user data directly
 inside a script is quite dangerous. Great care must be taken to prevent putting user data
 directly into script code itself, as no amount of encoding will prevent attacks there.
 
 This method is not recommended as VBScript is only supported by Internet Explorer
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#encodeForVBScript(java.lang.String)">encodeForVBScript</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to encode for VBScript
<DT><B>Returns:</B><DD>input encoded for use in VBScript</DL>
</DD>
</DL>
<HR>

<A NAME="encodeForSQL(org.owasp.esapi.codecs.Codec, java.lang.String)"><!-- --></A><H3>
encodeForSQL</H3>
<PRE>
public java.lang.String <B>encodeForSQL</B>(<A HREF="../../../../org/owasp/esapi/codecs/Codec.html" title="interface in org.owasp.esapi.codecs">Codec</A>&nbsp;codec,
                                     java.lang.String&nbsp;input)</PRE>
<DL>
<DD>Encode input for use in a SQL query, according to the selected codec 
 (appropriate codecs include the MySQLCodec and OracleCodec).
 
 This method is not recommended. The use of the PreparedStatement 
 interface is the preferred approach. However, if for some reason 
 this is impossible, then this method is provided as a weaker 
 alternative. 
 
 The best approach is to make sure any single-quotes are double-quoted.
 Another possible approach is to use the {escape} syntax described in the
 JDBC specification in section 1.5.6.
 
 However, this syntax does not work with all drivers, and requires
 modification of all queries.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#encodeForSQL(org.owasp.esapi.codecs.Codec, java.lang.String)">encodeForSQL</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>codec</CODE> - a Codec that declares which database 'input' is being encoded for (ie. MySQL, Oracle, etc.)<DD><CODE>input</CODE> - the text to encode for SQL
<DT><B>Returns:</B><DD>input encoded for use in SQL<DT><B>See Also:</B><DD><a href="http://java.sun.com/j2se/1.4.2/docs/guide/jdbc/getstart/statement.html">JDBC Specification</a></DL>
</DD>
</DL>
<HR>

<A NAME="encodeForOS(org.owasp.esapi.codecs.Codec, java.lang.String)"><!-- --></A><H3>
encodeForOS</H3>
<PRE>
public java.lang.String <B>encodeForOS</B>(<A HREF="../../../../org/owasp/esapi/codecs/Codec.html" title="interface in org.owasp.esapi.codecs">Codec</A>&nbsp;codec,
                                    java.lang.String&nbsp;input)</PRE>
<DL>
<DD>Encode for an operating system command shell according to the selected codec (appropriate codecs include
 the WindowsCodec and UnixCodec).
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#encodeForOS(org.owasp.esapi.codecs.Codec, java.lang.String)">encodeForOS</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>codec</CODE> - a Codec that declares which operating system 'input' is being encoded for (ie. Windows, Unix, etc.)<DD><CODE>input</CODE> - the text to encode for the command shell
<DT><B>Returns:</B><DD>input encoded for use in command shell</DL>
</DD>
</DL>
<HR>

<A NAME="encodeForLDAP(java.lang.String)"><!-- --></A><H3>
encodeForLDAP</H3>
<PRE>
public java.lang.String <B>encodeForLDAP</B>(java.lang.String&nbsp;input)</PRE>
<DL>
<DD>Encode data for use in LDAP queries.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#encodeForLDAP(java.lang.String)">encodeForLDAP</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to encode for LDAP
<DT><B>Returns:</B><DD>input encoded for use in LDAP</DL>
</DD>
</DL>
<HR>

<A NAME="encodeForDN(java.lang.String)"><!-- --></A><H3>
encodeForDN</H3>
<PRE>
public java.lang.String <B>encodeForDN</B>(java.lang.String&nbsp;input)</PRE>
<DL>
<DD>Encode data for use in an LDAP distinguished name.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#encodeForDN(java.lang.String)">encodeForDN</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to encode for an LDAP distinguished name
<DT><B>Returns:</B><DD>input encoded for use in an LDAP distinguished name</DL>
</DD>
</DL>
<HR>

<A NAME="encodeForXPath(java.lang.String)"><!-- --></A><H3>
encodeForXPath</H3>
<PRE>
public java.lang.String <B>encodeForXPath</B>(java.lang.String&nbsp;input)</PRE>
<DL>
<DD>Encode data for use in an XPath query.
 
 NB: The reference implementation encodes almost everything and may over-encode. 
 
 The difficulty with XPath encoding is that XPath has no built in mechanism for escaping
 characters. It is possible to use XQuery in a parameterized way to
 prevent injection. 
 
 For more information, refer to <a
 href="http://www.ibm.com/developerworks/xml/library/x-xpathinjection.html">this
 article</a> which specifies the following list of characters as the most
 dangerous: ^&"*';<>(). <a
 href="http://www.packetstormsecurity.org/papers/bypass/Blind_XPath_Injection_20040518.pdf">This
 paper</a> suggests disallowing ' and " in queries.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#encodeForXPath(java.lang.String)">encodeForXPath</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to encode for XPath
<DT><B>Returns:</B><DD>input encoded for use in XPath<DT><B>See Also:</B><DD><a href="http://www.ibm.com/developerworks/xml/library/x-xpathinjection.html">XPath Injection [ibm.com]</a>, 
<a href="http://www.packetstormsecurity.org/papers/bypass/Blind_XPath_Injection_20040518.pdf">Blind XPath Injection [packetstormsecurity.org]</a></DL>
</DD>
</DL>
<HR>

<A NAME="encodeForXML(java.lang.String)"><!-- --></A><H3>
encodeForXML</H3>
<PRE>
public java.lang.String <B>encodeForXML</B>(java.lang.String&nbsp;input)</PRE>
<DL>
<DD>Encode data for use in an XML element. The implementation should follow the <a
 href="http://www.w3schools.com/xml/xml_encoding.asp">XML Encoding
 Standard</a> from the W3C.
 <p>
 The use of a real XML parser is strongly encouraged. However, in the
 hopefully rare case that you need to make sure that data is safe for
 inclusion in an XML document and cannot use a parse, this method provides
 a safe mechanism to do so.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#encodeForXML(java.lang.String)">encodeForXML</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to encode for XML
<DT><B>Returns:</B><DD>input encoded for use in XML<DT><B>See Also:</B><DD><a href="http://www.w3schools.com/xml/xml_encoding.asp">XML Encoding Standard</a></DL>
</DD>
</DL>
<HR>

<A NAME="encodeForXMLAttribute(java.lang.String)"><!-- --></A><H3>
encodeForXMLAttribute</H3>
<PRE>
public java.lang.String <B>encodeForXMLAttribute</B>(java.lang.String&nbsp;input)</PRE>
<DL>
<DD>Encode data for use in an XML attribute. The implementation should follow
 the <a href="http://www.w3schools.com/xml/xml_encoding.asp">XML Encoding
 Standard</a> from the W3C.
 <p>
 The use of a real XML parser is highly encouraged. However, in the
 hopefully rare case that you need to make sure that data is safe for
 inclusion in an XML document and cannot use a parse, this method provides
 a safe mechanism to do so.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#encodeForXMLAttribute(java.lang.String)">encodeForXMLAttribute</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to encode for use as an XML attribute
<DT><B>Returns:</B><DD>input encoded for use in an XML attribute<DT><B>See Also:</B><DD><a href="http://www.w3schools.com/xml/xml_encoding.asp">XML Encoding Standard</a></DL>
</DD>
</DL>
<HR>

<A NAME="encodeForURL(java.lang.String)"><!-- --></A><H3>
encodeForURL</H3>
<PRE>
public java.lang.String <B>encodeForURL</B>(java.lang.String&nbsp;input)
                              throws <A HREF="../../../../org/owasp/esapi/errors/EncodingException.html" title="class in org.owasp.esapi.errors">EncodingException</A></PRE>
<DL>
<DD>Encode for use in a URL. This method performs <a
 href="http://en.wikipedia.org/wiki/Percent-encoding">URL encoding</a>
 on the entire string.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#encodeForURL(java.lang.String)">encodeForURL</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to encode for use in a URL
<DT><B>Returns:</B><DD>input 
 		encoded for use in a URL
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/owasp/esapi/errors/EncodingException.html" title="class in org.owasp.esapi.errors">EncodingException</A></CODE> - if encoding fails<DT><B>See Also:</B><DD><a href="http://en.wikipedia.org/wiki/Percent-encoding">URL encoding</a></DL>
</DD>
</DL>
<HR>

<A NAME="decodeFromURL(java.lang.String)"><!-- --></A><H3>
decodeFromURL</H3>
<PRE>
public java.lang.String <B>decodeFromURL</B>(java.lang.String&nbsp;input)
                               throws <A HREF="../../../../org/owasp/esapi/errors/EncodingException.html" title="class in org.owasp.esapi.errors">EncodingException</A></PRE>
<DL>
<DD>Decode from URL. Implementations should first canonicalize and
 detect any double-encoding. If this check passes, then the data is decoded using URL
 decoding.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#decodeFromURL(java.lang.String)">decodeFromURL</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to decode from an encoded URL
<DT><B>Returns:</B><DD>the decoded URL value
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/owasp/esapi/errors/EncodingException.html" title="class in org.owasp.esapi.errors">EncodingException</A></CODE> - if decoding fails</DL>
</DD>
</DL>
<HR>

<A NAME="encodeForBase64(byte[], boolean)"><!-- --></A><H3>
encodeForBase64</H3>
<PRE>
public java.lang.String <B>encodeForBase64</B>(byte[]&nbsp;input,
                                        boolean&nbsp;wrap)</PRE>
<DL>
<DD>Encode for Base64.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#encodeForBase64(byte[], boolean)">encodeForBase64</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the text to encode for Base64<DD><CODE>wrap</CODE> - the encoder will wrap lines every 64 characters of output
<DT><B>Returns:</B><DD>input encoded for Base64</DL>
</DD>
</DL>
<HR>

<A NAME="decodeFromBase64(java.lang.String)"><!-- --></A><H3>
decodeFromBase64</H3>
<PRE>
public byte[] <B>decodeFromBase64</B>(java.lang.String&nbsp;input)
                        throws java.io.IOException</PRE>
<DL>
<DD>Decode data encoded with BASE-64 encoding.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/Encoder.html#decodeFromBase64(java.lang.String)">decodeFromBase64</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/Encoder.html" title="interface in org.owasp.esapi">Encoder</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the Base64 text to decode
<DT><B>Returns:</B><DD>input 
 		decoded from Base64
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="isContained(char[], char)"><!-- --></A><H3>
isContained</H3>
<PRE>
protected boolean <B>isContained</B>(char[]&nbsp;haystack,
                              char&nbsp;c)</PRE>
<DL>
<DD>isContained is a helper method which determines if c is 
 contained in the character array haystack.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>haystack</CODE> - a character array containing a set of characters to be searched<DD><CODE>c</CODE> - a character to be searched for
<DT><B>Returns:</B><DD>true if c is in haystack, false otherwise</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/DefaultEncoder.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../../../../org/owasp/esapi/reference/DefaultEncryptedProperties.html" title="class in org.owasp.esapi.reference"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="DefaultEncoder.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>

</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
